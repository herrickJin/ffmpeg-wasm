# FFmpeg WASM 视频转码演示

这是一个基于 FFmpeg WASM 的视频转码演示项目，支持在浏览器中直接进行视频格式转换和播放。

## 功能特性

- 🎬 **多格式支持**: 支持 AVI, MOV, MKV, WMV, FLV 等格式转码为 MP4, WebM, AVI, MOV
- ⚡ **实时转码**: 使用 WebAssembly 在浏览器中进行高性能视频转码
- 📊 **性能监控**: 实时显示转码进度、时间、内存使用等性能指标
- 🎯 **参数控制**: 可调节视频编码器、质量、编码速度等参数
- 📱 **响应式设计**: 支持桌面和移动设备
- 🔧 **调试功能**: 提供详细的日志输出和错误处理

## 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

项目将在 http://localhost:3000 启动

### 构建生产版本

```bash
npm run build
```

### 预览生产版本

```bash
npm run preview
```

## 使用方法

1. **上传视频**: 点击上传区域或拖拽视频文件到页面
2. **设置参数**: 选择输出格式、编码器、质量和速度
3. **开始转码**: 点击"开始转码"按钮
4. **查看结果**: 转码完成后可以预览和下载视频

## 支持的格式

### 输入格式
- MP4, AVI, MOV, MKV, WMV, FLV, WebM
- 其他浏览器支持的视频格式

### 输出格式
- **MP4**: H.264/H.265 编码，推荐用于网页播放
- **WebM**: VP8/VP9 编码，适合现代浏览器
- **AVI**: 兼容性好的传统格式
- **MOV**: Apple 设备友好格式

## 编码器选项

- **H.264 (libx264)**: 最广泛兼容的视频编码器
- **H.265 (libx265)**: 更高效的编码，文件更小但兼容性稍差
- **VP8 (libvpx)**: WebM 格式的编码器
- **VP9 (libvpx-vp9)**: VP8 的升级版，效率更高

## 性能优化

### CRF (质量参数)
- 范围: 18-30 (数值越小质量越高)
- 推荐: 23 (平衡质量和文件大小)

### 编码速度预设
- **ultrafast**: 最快，但文件较大
- **medium**: 平衡速度和质量
- **veryslow**: 最慢，但文件最小

## 性能监控

项目提供详细的性能指标：
- **转码时间**: 总耗时统计
- **文件大小变化**: 转码前后文件大小对比
- **处理速度**: MB/s 的处理速度
- **内存使用**: JavaScript 堆内存使用情况
- **实时日志**: 详细的操作日志

## 浏览器兼容性

- Chrome 57+
- Firefox 52+
- Safari 11+
- Edge 79+

需要支持 WebAssembly 和 SharedArrayBuffer。

## 项目结构

```
ffmpeg-wasm/
├── index.html          # 主页面
├── src/
│   └── main.js        # 主要逻辑
├── package.json        # 项目配置
├── vite.config.js      # Vite 配置
└── CLAUDE.md          # 开发指南
```

## 技术栈

- **Vite**: 现代前端构建工具
- **FFmpeg WASM**: WebAssembly 版本的 FFmpeg
- **Vanilla JavaScript**: 纯 JavaScript 实现
- **CSS3**: 现代样式和动画

## 注意事项

1. **内存使用**: 大文件转码可能需要较多内存
2. **处理时间**: 复杂转码可能需要较长时间
3. **浏览器限制**: 不同浏览器可能有不同的性能表现
4. **文件大小**: 建议测试时使用较小的视频文件

## 故障排除

### 常见问题

1. **FFmpeg 加载失败**: 检查网络连接，可能需要配置 CDN
2. **转码速度慢**: 尝试降低质量设置或使用更快的编码预设
3. **内存不足**: 使用较小的视频文件或简化转码参数
4. **浏览器不兼容**: 确保使用支持 WebAssembly 的现代浏览器

### 调试技巧

- 打开浏览器开发者工具查看控制台日志
- 检查网络面板中的资源加载情况
- 使用性能面板分析内存和 CPU 使用情况

## 许可证

本项目使用 ISC 许可证。FFmpeg 的许可证取决于具体的编码器选择。